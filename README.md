# üõ° PublicGuard

![PublicGuard](PublicGuard.png)

–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP-–∞–¥—Ä–µ—Å–æ–≤ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö Threat Intelligence –ø–ª–∞—Ç—Ñ–æ—Ä–º –∏ —Å–∏—Å—Ç–µ–º —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –æ –ø—É–±–ª–∏—á–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö.

## –ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ

–ü—É–±–ª–∏—á–Ω—ã–µ —Å–∫–∞–Ω–µ—Ä—ã (Shodan, Censys, ZoomEye, FOFA, BinaryEdge –∏ –¥—Ä.) –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –∏–Ω–¥–µ–∫—Å–∏—Ä—É—é—Ç –º–∏–ª–ª–∏–æ–Ω—ã IP‚Äë–∞–¥—Ä–µ—Å–æ–≤.  

–õ—é–±–æ–π —Å–µ—Ä–≤–∏—Å, –¥–∞–∂–µ —Ç–µ—Å—Ç–æ–≤—ã–π –∏–ª–∏ dev‚Äë–æ–∫—Ä—É–∂–µ–Ω–∏–µ, –º–æ–∂–µ—Ç —Å–ª—É—á–∞–π–Ω–æ –ø–æ–ø–∞—Å—Ç—å –≤ –∏—Ö –±–∞–∑—ã –∏ –æ–∫–∞–∑–∞—Ç—å—Å—è –≤ Threat Intelligence –æ—Ç—á—ë—Ç–∞—Ö. –≠—Ç–æ —Å–æ–∑–¥–∞—ë—Ç —Ä–∏—Å–∫–∏:

‚Ä¢  üîç **–ò–∑–±—ã—Ç–æ—á–Ω–∞—è –≤–∏–¥–∏–º–æ—Å—Ç—å** ‚Äî –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø—É–±–ª–∏—á–Ω–æ–π, —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∞–º –∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞–º.

‚Ä¢  ‚ö†Ô∏è **–ü–æ–≤—ã—à–µ–Ω–Ω—ã–π —Ä–∏—Å–∫ –∞—Ç–∞–∫** ‚Äî —Ç–µ—Å—Ç–æ–≤—ã–µ –∏ dev‚Äë—Å–µ—Ä–≤–µ—Ä–∞ —á–∞—Å—Ç–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã ¬´–Ω–∞ —Å–∫–æ—Ä—É—é —Ä—É–∫—É¬ª –∏ —Å–æ–¥–µ—Ä–∂–∞—Ç —É—è–∑–≤–∏–º–æ—Å—Ç–∏.

‚Ä¢  üõ° **–õ–∏—à–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ –∑–∞—â–∏—Ç—É** ‚Äî –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —à—É–º, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –±—ã–ª–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –∑–∞—Ä–∞–Ω–µ–µ.

## –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –ø—Ä–æ–µ–∫—Ç

–ú—ã —Å–æ–±—Ä–∞–ª–∏ —Å–ø–∏—Å–æ–∫ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ IP –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Å–∫–∞–Ω–∏—Ä—É—é—â–∏—Ö —Å–∏—Å—Ç–µ–º –∏ —Å–µ—Ä–≤–∏—Å–æ–≤ —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö.  

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç –ø—Ä–∞–≤–∏–ª–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –≤—Ö–æ–¥—è—â–µ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ –æ—Ç —ç—Ç–∏—Ö –∞–¥—Ä–µ—Å–æ–≤ —á–µ—Ä–µ–∑ `iptables` –∏ `ipset`.

## –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

### –û–¥–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
curl -fsSL https://raw.githubusercontent.com/cleverg0d/PublicGuard/main/block_scanners.sh | sudo bash
```

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (iptables, ipset, curl, fail2ban)
- –°–∫–∞—á–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ IP —Å GitHub
- –°–æ–∑–¥–∞—Å—Ç ipset –¥–ª—è IPv4 –∏ IPv6
- –ù–∞—Å—Ç—Ä–æ–∏—Ç iptables –ø—Ä–∞–≤–∏–ª–∞ —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- –ó–∞–±–ª–æ–∫–∏—Ä—É–µ—Ç —Ç—Ä–∞—Ñ–∏–∫ –æ—Ç –≤—Å–µ—Ö —Å–∫–∞–Ω–µ—Ä–æ–≤ –∏–∑ —Å–ø–∏—Å–∫–∞

### –õ–æ–∫–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
git clone https://github.com/cleverg0d/PublicGuard.git
cd PublicGuard
sudo ./block_scanners.sh --sync --flush
```

## –ß—Ç–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è

- **Shodan** ‚Äî –ø–æ–ø—É–ª—è—Ä–Ω—ã–π –ø–æ–∏—Å–∫–æ–≤–∏–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ
- **Censys** ‚Äî –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- **ZoomEye** (CN) ‚Äî –∫–∏—Ç–∞–π—Å–∫–∏–π –ø–æ–∏—Å–∫–æ–≤–∏–∫ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
- **FOFA** (CN) ‚Äî –∫–∏—Ç–∞–π—Å–∫–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
- **BinaryEdge** ‚Äî —Å–µ—Ä–≤–∏—Å –¥–ª—è –ø–æ–∏—Å–∫–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
- **Shadowserver** ‚Äî –Ω–µ–∫–æ–º–º–µ—Ä—á–µ—Å–∫–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **Rapid7 Project Sonar** ‚Äî –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ–µ–∫—Ç –ø–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—é
- **–ö–∏—Ç–∞–π—Å–∫–∏–µ –∫–æ–ª–ª–µ–∫—Ç–æ—Ä—ã**: Baidu, Tencent Cloud, Alibaba Cloud

–ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ IP-–∞–¥—Ä–µ—Å–æ–≤ –∏ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ [`scanners_list.txt`](scanners_list.txt).

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ iptables
sudo iptables -L SCANNER_BLOCK_V4 -n -v
sudo ip6tables -L SCANNER_BLOCK_V6 -n -v

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ ipset
sudo ipset list scanner_block_v4 | head -20
sudo ipset list scanner_block_v6 | head -20

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
sudo journalctl -k | grep SCANNER_BLOCK
# –∏–ª–∏
sudo dmesg | grep SCANNER_BLOCK
```

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞

–°–ø–∏—Å–æ–∫ IP-–∞–¥—Ä–µ—Å–æ–≤ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏. –ß—Ç–æ–±—ã –ø—Ä–∏–º–µ–Ω–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:

```bash
# –ï—Å–ª–∏ –∑–∞–ø—É—Å–∫–∞–ª–∏ —á–µ—Ä–µ–∑ curl|bash
curl -fsSL https://raw.githubusercontent.com/cleverg0d/PublicGuard/main/block_scanners.sh | sudo bash

# –ï—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ
cd PublicGuard
git pull
sudo ./block_scanners.sh --sync --flush
```

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (cron)

–î–æ–±–∞–≤—å—Ç–µ –≤ crontab –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:

```bash
sudo crontab -e
```

–î–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫—É:
```
0 2 * * * curl -fsSL https://raw.githubusercontent.com/cleverg0d/PublicGuard/main/block_scanners.sh | bash
```

## –û–ø—Ü–∏–∏ —Å–∫—Ä–∏–ø—Ç–∞

```bash
sudo ./block_scanners.sh [–æ–ø—Ü–∏–∏]

–û–ø—Ü–∏–∏:
  --sync           –°–∫–∞—á–∞—Ç—å —Å–≤–µ–∂–∏–π —Å–ø–∏—Å–æ–∫ —Å GitHub –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º
  --flush          –û—á–∏—Å—Ç–∏—Ç—å ipset –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π –Ω–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π
  --dry-run        –ü–æ–∫–∞–∑–∞—Ç—å —á—Ç–æ –±—É–¥–µ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –±–µ–∑ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª
  --list <path>    –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π —Ñ–∞–π–ª —Å–æ —Å–ø–∏—Å–∫–æ–º
  -h, --help       –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É
```

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Linux —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π `iptables` –∏ `ipset`
- –ü—Ä–∞–≤–∞ root (sudo)
- –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

## –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª

```bash
# –£–¥–∞–ª–∏—Ç—å —Ü–µ–ø–æ—á–∫–∏ iptables
sudo iptables -D INPUT -j SCANNER_BLOCK_V4
sudo iptables -F SCANNER_BLOCK_V4
sudo iptables -X SCANNER_BLOCK_V4

sudo ip6tables -D INPUT -j SCANNER_BLOCK_V6
sudo ip6tables -F SCANNER_BLOCK_V6
sudo ip6tables -X SCANNER_BLOCK_V6

# –£–¥–∞–ª–∏—Ç—å ipset
sudo ipset destroy scanner_block_v4
sudo ipset destroy scanner_block_v6
```

## –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è Pull Request'—ã —Å:
- –ù–æ–≤—ã–º–∏ IP-–∞–¥—Ä–µ—Å–∞–º–∏ —Å–∫–∞–Ω–µ—Ä–æ–≤ (—Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫–∞)
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤
- –£–ª—É—á—à–µ–Ω–∏—è–º–∏ —Å–∫—Ä–∏–ø—Ç–∞

**–í–∞–∂–Ω–æ**: –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ IP-–∞–¥—Ä–µ—Å–æ–≤ —É–∫–∞–∑—ã–≤–∞–π—Ç–µ –∏—Å—Ç–æ—á–Ω–∏–∫ –∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Å–∫–∞–Ω–µ—Ä—ã, –∞ –Ω–µ –ª–µ–≥–∏—Ç–∏–º–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã.

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License

## ‚ö†Ô∏è Disclaimer

–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å–∫–∞–Ω–µ—Ä–æ–≤ –º–æ–∂–µ—Ç –ø–æ–º–µ—à–∞—Ç—å –ª–µ–≥–∏—Ç–∏–º–Ω—ã–º –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–∞ —Å–≤–æ–π —Ä–∏—Å–∫. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–µ –Ω–∞—Ä—É—à–∞–µ—Ç –ø–æ–ª–∏—Ç–∏–∫–∏ –≤–∞—à–µ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏.
